<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"/>
</h:head>
<h:body>
    <c:set value="#{userBean.user}" var="currUser"/>
    <h:outputStylesheet library="css" name="styles.css"/>
    <div style="clear: both ;margin-bottom:4%; position:relative;">
        <h:graphicImage value="/resources/images/myLogo.png" width="100%"/>
        <div style="position: absolute; right:5%; top: 95%;">
            <h:form>

                <h:commandButton styleClass="btn  btn-primary glyphicon glyphicon-find "
                                 action="/pages/index.xhtml?faces-redirect=true" value=" Find tickets"/>
                <h:commandLink styleClass="btn btn-primary glyphicon glyphicon-user"
                               action="/pages/personal_cabinet.xhtml?faces-redirect=true" value=" Personal cabinet"/>
                <h:commandLink styleClass="btn btn-primary glyphicon glyphicon-log-in"
                               action="#{authorizationBean.logOut}" value=" Log Out"/>


            </h:form>
        </div>
    </div>


    <c:set var="isAdmin" value="#{facesContext.externalContext.isUserInRole('admin')}"/>
    <h:form>
        <div class="col-md-3">
            <ul class="nav nav-pills nav-stacked">
                <li class="active">
                    <a href="#">Personal information</a>
                </li>
                <li>
                    <h:commandLink action="/pages/personal_tickets.xhtml?faces-redirect=true" value="Your tickets"/>
                </li>
                <ui:fragment rendered="#{isAdmin}">
                    <li>
                        <ul class="nav nav-pills nav-stacked">
                            <li>
                                <h:commandLink action="/pages/create_pages/create_address.xhtml?faces-redirect=true"
                                               value="Manage addresses"/>
                            </li>

                            <li>
                                <h:commandLink action="/pages/create_pages/create_company.xhtml?faces-redirect=true"
                                               value="Manage airline companies"/>
                            </li>
                            <li>
                                <h:commandLink action="/pages/create_pages/create_route.xhtml?faces-redirect=true"
                                               value="Manage routes"/>
                            </li>

                            <li>
                                <h:commandLink action="/pages/create_pages/create_flight.xhtml?faces-redirect=true"
                                               value="Manage flights"/>

                            </li>

                        </ul>
                    </li>
                </ui:fragment>
            </ul>
        </div>
    </h:form>

    <div class="container">
        <div class="panel panel-info col-md-offset-3 ">
            <div class="panel-heading ">
                Your personal information
            </div>
            <div class="panel-body">
                <div class="col-md-4">
                    <h:graphicImage value="/resources/images/user_pic/pic1.png" width="100%"/>
                </div>
                <div class="col-md-8">

                    <h:form id="personal_info">
                        <table class="table table-hover">
                            <tr>
                                <td>
                                    <b>First name:</b><span class="glyphicons glyphicons-address-book"/>
                                </td>
                                <td>
                                    <h:inputText id="first_name" value="#{currUser.firstName}"
                                                 rendered="#{userBean.editable}"/>
                                    <h:outputText value="#{currUser.firstName}" rendered="#{!userBean.editable}"/>
                                </td>

                            </tr>
                            <tr>
                                <td>
                                    <b>Last name:</b><span class="glyphicons glyphicons-address-book"/>
                                </td>
                                <td>
                                    <h:inputText id="last_name" value="#{currUser.lastName}"
                                                 rendered="#{userBean.editable}"/>
                                    <h:outputText value="#{currUser.lastName}" rendered="#{!userBean.editable}"/>
                                </td>

                            </tr>
                            <tr>
                                <td>
                                    <b>E-mail:</b><span class="social social-gmai"/>
                                </td>
                                <td>
                                    <h:inputText id="e_mail" value="#{currUser.eMail}" rendered="#{userBean.editable}"/>
                                    <h:outputText value="#{currUser.eMail}" rendered="#{!userBean.editable}"/>
                                </td>

                            </tr>
                        </table>


                        <h:commandButton value="Edit" action="#{userBean.edit}" styleClass="btn btn-primary"
                                         rendered="#{!userBean.editable}">
                            <f:ajax render="personal_info"/>
                        </h:commandButton>
                        <h:commandButton value="Save" action="#{userBean.saveUser}" styleClass="btn btn-primary"
                                         rendered="#{userBean.editable}">
                            <f:ajax execute="first_name lastName e_mail" render="personal_info"/>
                        </h:commandButton>
                    </h:form>


                </div>
            </div>
        </div>
    </div>


</h:body>
</html>
